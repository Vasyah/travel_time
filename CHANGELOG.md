# Changelog

## [0.3.4] - 2024-12-19

### Рефакторинг

- Выделена общая часть компонентов HotelCalendar и Calendar в базовый компонент BaseCalendar
- Упрощена архитектура календарных компонентов для лучшей поддерживаемости
- Добавлена возможность кастомизации рендеринга Timeline через renderTimeline пропс
- Улучшена типизация и структура кода

## [0.3.3] - 2024-12-19

### Добавлено

- Добавлена сортировка отелей в алфавитном порядке на главной странице
- Добавлена сортировка номеров отеля в алфавитном порядке на странице номеров

## [0.3.2] - 2024-06-24

### Изменено

- Изменена патч-версия в package.json
- Теперь бронирование отеля открывается в новой вкладке

## [0.3.0] - 2025-06-23

### Исправлено

- Добавлена виртуализация
- Улучшена логика фильтрации поиска: теперь onSearch не выполняется, если все значения фильтра не заданы
- Исправлена работа поиска по отелям, восстановлена корректная фильтрация
- Добавлена виртуализация для повышения производительности списка
- Удалено поле вместимости номера из фильтрации
- Проведена автоматическая правка кода (lint fix)

## [0.2.0] - 2024-03-19

### Добавлено

- Добавлена утилита для логирования в development режиме
- Добавлена поддержка z-index через CSS переменные
- Улучшена типизация для компонентов форм

### Исправлено

- Исправлена проблема с z-index в модальных окнах
- Исправлена валидация полей формы
- Исправлена обработка числовых значений в полях ввода

## [0.1.0] - 06.05.2025

### Добавлено

- Конвертация стилей в SCSS
    - Создан файл variables.scss с общими переменными и миксинами
    - Создан файл globals.scss с глобальными стилями
    - Конвертированы стили компонентов в SCSS
    - Добавлена поддержка вложенных правил и миксинов
    - Улучшена организация медиа-запросов

## 28.04.2025 Добавлен API для обновления порядка номеров

**Описание:** Добавлена функциональность для сохранения нового порядка номеров в базе данных через Supabase. Создан хук `useUpdateRoomOrder` для управления мутацией обновления порядка.

**Изменения:**

- Создана функция `updateRoomOrder` в `src/shared/api/room/room.ts`
- Добавлен хук `useUpdateRoomOrder` для управления мутацией
- Обновлены `Calendar.tsx` и `HotelCalendar.tsx` для использования нового API
- Добавлена инвалидация кеша после успешного обновления
- Добавлены уведомления об успешном обновлении и ошибках

**Технические детали:**

- Функция сначала сбрасывает `order_index` для всех номеров отеля
- Затем обновляет `order_index` для каждого номера в новом порядке
- Используется `upsert` для обновления записей с конфликтом по `id`
- Автоматическая инвалидация кеша для обновления UI
- Обработка ошибок с показом уведомлений пользователю

**Новые возможности:**

- Сохранение нового порядка номеров в базе данных
- Автоматическое обновление UI после изменения порядка
- Уведомления пользователя о статусе операции
- Обработка ошибок при обновлении

## 28.04.2025 Добавлена функциональность перетаскивания групп в календаре

**Описание:** Добавлена возможность перетаскивания групп (номеров отелей) в компонентах календаря с помощью библиотеки @dnd-kit. Каждый Timeline теперь имеет уникальный идентификатор, что позволяет использовать несколько календарей на одной странице без конфликтов.

**Изменения:**

- Установлены зависимости @dnd-kit/core, @dnd-kit/sortable, @dnd-kit/utilities
- Создан компонент `DraggableGroup` для отображения перетаскиваемых групп с иконкой
- Создан компонент `DndTimelineWrapper` для обертки Timeline в DnD зону
- Обновлен компонент `Timeline` для поддержки перетаскивания групп
- Добавлен `groupRenderer` для кастомизации отображения групп
- Обновлены `Calendar.tsx` и `HotelCalendar.tsx` для поддержки новой функциональности
- Добавлены стили для компонентов перетаскивания
- Каждый Timeline теперь имеет уникальный `timelineId` для изоляции зон перетаскивания

**Новые возможности:**

- Перетаскивание номеров отелей в рамках календаря
- Визуальная обратная связь при перетаскивании
- Уникальные идентификаторы для каждого Timeline
- Кастомизируемые стили для групп
- Поддержка множественных календарей на одной странице

**Технические детали:**

- Использование PointerSensor для активации перетаскивания
- Поддержка вертикального сортирования групп
- DragOverlay для визуального отображения перетаскиваемого элемента
- Обработка событий перетаскивания в родительских компонентах

## 28.04.2025 Вынесен компонент Timeline в отдельную папку

**Описание:** Компонент Timeline был вынесен из Calendar и HotelCalendar в отдельную папку `feature/BaseCalendar/ui/Timeline`. Это позволило избежать дублирования кода между двумя компонентами календаря и улучшить архитектуру проекта.

**Изменения:**

- Создан новый компонент `Timeline` в `src/features/BaseCalendar/ui/Timeline.tsx`
- Обновлен `Calendar.tsx` для использования нового компонента Timeline
- Обновлен `HotelCalendar.tsx` для использования нового компонента Timeline
- Создан файл стилей `src/features/BaseCalendar/ui/style.module.scss`
- Удален дублированный код из обоих компонентов календаря

**Преимущества:**

- Устранено дублирование кода между Calendar и HotelCalendar
- Улучшена поддерживаемость кода
- Упрощена архитектура проекта
- Компонент Timeline стал переиспользуемым

## 28.04.2025 Добавлена авторизация

**Описание:** Была добавлена авторизация, в приложении появилась форма авторизации, добавлены такие-то компоненты и краткое описание выполненных изменений.
